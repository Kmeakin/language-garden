(rule
  (with-stdin-from categories.txt
    (with-stdout-to categories.stdout.exp
      (run %{bin:record-patching} elab))))

(rule
  (alias runtest)
  (package elab-record-patching)
  (action (diff expected/categories.stdout
                categories.stdout.exp)))

(rule
  (with-stdin-from let-ann-check.txt
    (with-stdout-to let-ann-check.stdout.exp
      (run %{bin:record-patching} elab))))

(rule
  (alias runtest)
  (package elab-record-patching)
  (action (diff expected/let-ann-check.stdout
                let-ann-check.stdout.exp)))

(rule
  (with-stdin-from let-ann-infer.txt
    (with-stdout-to let-ann-infer.stdout.exp
      (run %{bin:record-patching} elab))))

(rule
  (alias runtest)
  (package elab-record-patching)
  (action (diff expected/let-ann-infer.stdout
                let-ann-infer.stdout.exp)))

(rule
  (with-stdin-from map.txt
    (with-stdout-to map.stdout.exp
      (run %{bin:record-patching} elab))))

(rule
  (alias runtest)
  (package elab-record-patching)
  (action (diff expected/map.stdout
                map.stdout.exp)))

(rule
  (with-stdin-from records.txt
    (with-stdout-to records.stdout.exp
      (run %{bin:record-patching} elab))))

(rule
  (alias runtest)
  (package elab-record-patching)
  (action (diff expected/records.stdout
                records.stdout.exp)))

(rule
  (with-stdin-from singletons.txt
    (with-stdout-to singletons.stdout.exp
      (run %{bin:record-patching} elab))))

(rule
  (alias runtest)
  (package elab-record-patching)
  (action (diff expected/singletons.stdout
                singletons.stdout.exp)))
